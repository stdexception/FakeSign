<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<style>
@font-face {
	font-family: "MapleMono SC NF Regular";
	src: url("https://pikachuim.github.io/OpenFont/font/MapleMono/MapleMono-SC-NF/MapleMono-SC-NF-Regular.ttf") format("truetype");
}

*{
	font-family: "MapleMono SC NF Regular";
}</style>
<style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color:#ffffff; --text-color:#333333; --select-text-bg-color:#B5D6FC; --select-text-font-color:auto; --monospace:"Lucida Console",Consolas,"Courier",monospace; --title-bar-height:20px; }
.mac-os-11 { --title-bar-height:28px; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
h1, h2, h3, h4, h5 { white-space: pre-wrap; }
body { margin: 0px; padding: 0px; height: auto; inset: 0px; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; overflow-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 36px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
.typora-export .task-list-item input { pointer-events: none; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; image-orientation: from-image; }
button, input, select, textarea { color: inherit; font: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 4; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.7); color: rgb(85, 85, 85); border-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px; }
thead, tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror-linenumber { user-select: none; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-fences-adv-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
svg { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: 0px 0px; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li blockquote { margin: 1rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print {
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; font-variant-ligatures: no-common-ligatures; }
  #write { margin-top: 0px; border-color: transparent !important; padding-top: 0px !important; padding-bottom: 0px !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  .typora-export #write { break-after: avoid; }
  .typora-export #write::after { height: 0px; }
  .is-mac table { break-inside: avoid; }
  #write > p:nth-child(1) { margin-top: 0px; }
  .typora-export-show-outline .typora-export-sidebar { display: none; }
  figure { overflow-x: visible; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
#write.first-line-indent p > .md-image:only-child:not(.md-img-error) img { left: -2em; position: relative; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
.MathJax_ref { fill: currentcolor; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.reversefootnote { font-family: ui-monospace, sans-serif; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.6; font-family: var(--monospace); }
code { text-align: left; vertical-align: initial; }
a.md-print-anchor { white-space: pre !important; border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; background: 0px 0px !important; text-decoration: initial !important; text-shadow: initial !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
mark { background: rgb(255, 255, 0); color: rgb(0, 0, 0); }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
.md-expand mark .md-meta { opacity: 0.3 !important; }
mark .md-meta { color: rgb(0, 0, 0); }
@media print {
  .typora-export h1, .typora-export h2, .typora-export h3, .typora-export h4, .typora-export h5, .typora-export h6 { break-inside: avoid; }
}
.md-diagram-panel .messageText { stroke: none !important; }
.md-diagram-panel .start-state { fill: var(--node-fill); }
.md-diagram-panel .edgeLabel rect { opacity: 1 !important; }
.md-fences.md-fences-math { font-size: 1em; }
.md-fences-advanced:not(.md-focus) { padding: 0px; white-space: nowrap; border: 0px; }
.md-fences-advanced:not(.md-focus) { background: inherit; }
.typora-export-show-outline .typora-export-content { max-width: 1440px; margin: auto; display: flex; flex-direction: row; }
.typora-export-sidebar { width: 300px; font-size: 0.8rem; margin-top: 80px; margin-right: 18px; }
.typora-export-show-outline #write { --webkit-flex:2; flex: 2 1 0%; }
.typora-export-sidebar .outline-content { position: fixed; top: 0px; max-height: 100%; overflow: hidden auto; padding-bottom: 30px; padding-top: 60px; width: 300px; }
@media screen and (max-width: 1024px) {
  .typora-export-sidebar, .typora-export-sidebar .outline-content { width: 240px; }
}
@media screen and (max-width: 800px) {
  .typora-export-sidebar { display: none; }
}
.outline-content li, .outline-content ul { margin-left: 0px; margin-right: 0px; padding-left: 0px; padding-right: 0px; list-style: none; overflow-wrap: anywhere; }
.outline-content ul { margin-top: 0px; margin-bottom: 0px; }
.outline-content strong { font-weight: 400; }
.outline-expander { width: 1rem; height: 1.42857rem; position: relative; display: table-cell; vertical-align: middle; cursor: pointer; padding-left: 4px; }
.outline-expander::before { content: ""; position: relative; font-family: Ionicons; display: inline-block; font-size: 8px; vertical-align: middle; }
.outline-item { padding-top: 3px; padding-bottom: 3px; cursor: pointer; }
.outline-expander:hover::before { content: ""; }
.outline-h1 > .outline-item { padding-left: 0px; }
.outline-h2 > .outline-item { padding-left: 1em; }
.outline-h3 > .outline-item { padding-left: 2em; }
.outline-h4 > .outline-item { padding-left: 3em; }
.outline-h5 > .outline-item { padding-left: 4em; }
.outline-h6 > .outline-item { padding-left: 5em; }
.outline-label { cursor: pointer; display: table-cell; vertical-align: middle; text-decoration: none; color: inherit; }
.outline-label:hover { text-decoration: underline; }
.outline-item:hover { border-color: rgb(245, 245, 245); background-color: var(--item-hover-bg-color); }
.outline-item:hover { margin-left: -28px; margin-right: -28px; border-left: 28px solid transparent; border-right: 28px solid transparent; }
.outline-item-single .outline-expander::before, .outline-item-single .outline-expander:hover::before { display: none; }
.outline-item-open > .outline-item > .outline-expander::before { content: ""; }
.outline-children { display: none; }
.info-panel-tab-wrapper { display: none; }
.outline-item-open > .outline-children { display: block; }
.typora-export .outline-item { padding-top: 1px; padding-bottom: 1px; }
.typora-export .outline-item:hover { margin-right: -8px; border-right: 8px solid transparent; }
.typora-export .outline-expander::before { content: "+"; font-family: inherit; top: -1px; }
.typora-export .outline-expander:hover::before, .typora-export .outline-item-open > .outline-item > .outline-expander::before { content: "−"; }
.typora-export-collapse-outline .outline-children { display: none; }
.typora-export-collapse-outline .outline-item-open > .outline-children, .typora-export-no-collapse-outline .outline-children { display: block; }
.typora-export-no-collapse-outline .outline-expander::before { content: "" !important; }
.typora-export-show-outline .outline-item-active > .outline-item .outline-label { font-weight: 700; }
.md-inline-math-container mjx-container { zoom: 0.95; }
mjx-container { break-inside: avoid; }


.CodeMirror { height: auto; }
.CodeMirror.cm-s-inner { background: inherit; }
.CodeMirror-scroll { overflow: auto hidden; z-index: 3; }
.CodeMirror-gutter-filler, .CodeMirror-scrollbar-filler { background-color: rgb(255, 255, 255); }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background: inherit; white-space: nowrap; }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: rgb(0, 0, 0); }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-property { color: rgb(0, 0, 0); }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: rgb(0, 0, 255); }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: 700; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: red; }
.cm-invalidchar { color: red; }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { height: 100%; outline: 0px; position: relative; box-sizing: content-box; background: inherit; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-gutter-filler, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-vscrollbar { position: absolute; z-index: 6; display: none; outline: 0px; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow: hidden; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow: auto hidden; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 10px; z-index: 3; overflow-y: hidden; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-wrapper { position: absolute; z-index: 4; background: 0px 0px !important; border: none !important; }
.CodeMirror-gutter-background { position: absolute; top: 0px; bottom: 0px; z-index: 4; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: 0px 0px; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; overflow-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { overflow-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; inset: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
span.cm-underlined { text-decoration: underline; }
span.cm-strikethrough { text-decoration: line-through; }
.cm-tw-syntaxerror { color: rgb(255, 255, 255); background-color: rgb(153, 0, 0); }
.cm-tw-deleted { text-decoration: line-through; }
.cm-tw-header5 { font-weight: 700; }
.cm-tw-listitem:first-child { padding-left: 10px; }
.cm-tw-box { border-style: solid; border-right-width: 1px; border-bottom-width: 1px; border-left-width: 1px; border-color: inherit; border-top-width: 0px !important; }
.cm-tw-underline { text-decoration: underline; }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}


/* 阿里普惠体 */
/* 思源黑体 */
/* 霞鹜文楷 */
/* 站酷仓耳渔阳体 */
@font-face {
    font-family: 'ZhanKu_YvYangTi';
    src: url('file:///C://Users//pikachuren//AppData//Roaming//Typora/themes/happysimple/source/font/%E7%AB%99%E9%85%B7%E4%BB%93%E8%80%B3%E6%B8%94%E9%98%B3%E4%BD%93/TsangerYuYangT_W05_W05.ttf') format('truetype');
    font-weight: 500;
}
.iconfont {
  font-family: "iconfont" !important;
  font-size: 16px;
  font-style: normal;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.icon-dian:before {
  content: "\e640";
}

.icon-xuanzeyixuan:before {
  content: "\e63c";
}

.icon-danger:before {
  content: "\e614";
}

.icon-Success:before {
  content: "\e605";
}

.icon-warning:before {
  content: "\e600";
}

.icon-info:before {
  content: "\e601";
}

.icon-dingwei:before {
  content: "\e650";
}

.icon-wenjian:before {
  content: "\e652";
}

.icon-shuju:before {
  content: "\e653";
}

.icon-biaoqian:before {
  content: "\e64a";
}

.icon-biaoqing:before {
  content: "\e64b";
}

.icon-jinggao:before {
  content: "\e64c";
}

.icon-dianzan:before {
  content: "\e64d";
}

.icon-xiangqing:before {
  content: "\e64e";
}

.icon-tishi:before {
  content: "\e64f";
}

.icon-bangzhu:before {
  content: "\e651";
}

.icon-wenjianjia:before {
  content: "\e652";
}

.icon-touxiang:before {
  content: "\e626";
}

.icon-jiedian:before {
  content: "\e649";
}

.icon-cengji:before {
  content: "\e67f";
}

@import '';
@import '';


/* --------------------------------------- PDF配置 --------------------------------------- */
@media print {
  @page {
  	margin: 2mm 0mm; 
  }
  html{
	font-size: 11px !important;
  }
  img {
    border: var(--img-border) !important;
    border-radius: var(--img-border-radius) !important;
  }
}

/* --------------------------------------- 全局配置 --------------------------------------- */
*{
    margin: 0px;
    padding: 0px;
}

html{
    font-size: var(--write-font-size);
}

body {
    background-color: var(--body-background-color);
}

#write {
    margin: var(--write-margin);
    padding: var(--write-padding);
    font-family: var(--write-font-family);
    font-weight: var(--write-font-weight);
    line-height: var(--write-line-height);
    color: var(--write-color);
    background: var(--write-background);
    border: var(--write-border);
    border-radius: var(--write-border-radius);
    max-width: var(--write-max-width);
    text-align: justify;
    letter-spacing: 0px;                 /* 字距 */
    word-spacing: 0px;                   /* 词距 */
    word-break: initial;                 /* 使用默认的断行规则 */
    overflow-x: auto;                    /* 内容溢出块级元素显示滚动条 */
}
/* --------------------------------------------------------------------------------------- */


/* --------------------------------------- Favico ---------------------------------------- */
body:not(.typora-sourceview-on) content {
    background-image: var(--favico-url);
    background-size : var(--favico-size);
    background-position: var(--favico-position);
    background-repeat: no-repeat;
}
/* --------------------------------------------------------------------------------------- */


/* ---------------------------------------- YAML ----------------------------------------- */
pre.md-meta-block {
    margin: var(--yaml-margin);
    padding: var(--yaml-padding);
    font-family: var(--yaml-font-family);
    font-size: var(--yaml-font-size);
    font-weight: var(--yaml-font-weight);
    line-height: var(--yaml-line-height);
    color: var(--yaml-color);
    background-color: var(--yaml-background-color);
    border: var(--yaml-border);
    border-radius: var(--yaml-border-radius);
}
/* --------------------------------------------------------------------------------------- */


/* ------------------------------------------ 目录 --------------------------------------- */
.md-toc {
    margin: var(--toc-margin);
    padding: var(--toc-padding);
    background-color: var(--toc-background-color);
    border: var(--toc-border);
    border-radius: var(--toc-border-radius);
}

.md-tooltip-hide>span {      /* 消除自带的"目录"二字 */
    display: none;
}

.md-toc:before {             /* 自定义"目录"二字 */
    position: relative;
    left: 5px;
    bottom: 0px;
    display: inline-block;
    content: '目录';
    font-family: var(--toc-title-font-family);
    font-size: var(--toc-title-font-size);
    font-weight: var(--toc-title-font-weight);
    line-height: var(--toc-title-line-height);
    color: var(--toc-title-color);
}

#write div.md-toc-tooltip {   /* 设置自带工具条 */
    position: absolute;
    top: -30px;
    border: none;
    background-color: transparent;
}

.md-toc-content,
.md-toc:focus .md-toc-content {
    margin: 0px;
    padding: 5px;
    line-height: var(--toc-content-line-height);
    border: none;
    border-top: var(--toc-content-border-top);
}

.md-toc-h1 .md-toc-inner{
    text-indent: 0em;
}
.md-toc-h2 .md-toc-inner{
    text-indent: 2em;
}
.md-toc-h3 .md-toc-inner{
    text-indent: 4em;
}

#write a.md-toc-inner {
    font-family: var(--toc-content-font-family);
    font-size: var(--toc-content-font-size);
    font-weight: var(--toc-content-font-weight);
    color: var(--toc-content-color);
    background-color: var(--toc-background-color);
    border-bottom: none;
}

#write a.md-toc-inner:hover{
    color: var(--toc-content-hover-color);
    font-weight: var(--toc-content-hover-font-weight);
    text-decoration: none;
}
/* --------------------------------------------------------------------------------------- */


/* ----------------------------------------- 标题 ---------------------------------------- */
h1 {
    margin: var(--h1-margin);
    padding: var(--h1-padding);
    font-family: var(--h1-font-family);
    font-size: var(--h1-font-size);
    font-weight: var(--h1-font-weight);
    line-height: var(--h1-font-line-height);
    display: block;
    text-align: center; 
}
h1 span{
    border-bottom: var(--h1-span-border-bottom);
}
h1:before {
    margin-right: var(--h1-icon-margin-right);
    font-family: "iconfont";
    content: var(--h1-icon);
    color: var(--h1-icon-color);
}

h2 {
    margin: var(--h2-margin);
    padding: var(--h2-padding);
    font-family: var(--h2-font-family);
    font-size: var(--h2-font-size);
    font-weight: var(--h2-font-weight);
    line-height: var(--h2-line-height);
    display: block;
    //text-align: left;
	text-align: center; 
}
h2 span{
    border-bottom: var(--h2-span-border-bottom);
}
h2:before {
    margin-right: var(--h2-icon-margin-right);
    font-family: "iconfont";
    content: var(--h2-icon);
    color: var(--h2-icon-color);
}

h3 {
    margin: var(--h3-margin);
    padding: var(--h3-padding);
    font-family: var(--h3-font-family);
    font-size: var(--h3-font-size);
    font-weight: var(--h3-font-weight);
    line-height: var(--h3-line-height);
    display: block;
    text-align: left;
}
h3 span{
    border-bottom: var(--h3-span-border-bottom);
}
h3:before {
    margin-right: var(--h3-icon-margin-right);
    font-family: "iconfont";
    content: var(--h3-icon);
    color: var(--h3-icon-color);
}
h3.md-focus:before{
    position: relative;
    top: 0px;
    left: 0px;
    margin-right: var(--h3-icon-margin-right);
    padding: 0px;
    font-family: "iconfont";
    content: var(--h3-icon);
    border: none;
    font-size: inherit;
    line-height: inherit;
    float: none;
    vertical-align: baseline;
}
/* --------------------------------------------------------------------------------------- */


/* ----------------------------------------- 引用块 -------------------------------------- */
blockquote{
    margin: var(--blockquote-margin);
    padding: var(--blockquote-padding);
    font-family: var(--blockquote-font-family);
    font-size: var(--blockquote-font-size);
    font-weight: var(--blockquote-font-weight);
    line-height: var(--blockquote-line-height);
    border-left: var(--blockquote-border-left);
    background-color:  var(--blockquote-background-color);
}

blockquote[alt="info"]>*,
blockquote[alt="warn"]>*,
blockquote[alt="success"]>*,
blockquote[alt="danger"]>* {
    margin-left: 1.5em;
}

blockquote[alt="info"] {
    border-left: var(--info-blockquote-border-left);
    background-color: var(--info-blockquote-background-color);
}
blockquote[alt="info"]:before {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    margin: 0px;
    padding-right: 5px;
    font-family: "iconfont";
    content: '\e601';
}

blockquote[alt="warn"] {
    border-left: var(--warn-blockquote-border-left);
    background-color: var(--warn-blockquote-background-color);
}
blockquote[alt="warn"]:before {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    margin: 0px;
    padding-right: 5px;
    font-family: "iconfont";
    content: '\e600';
}

blockquote[alt="danger"] {
    border-left: var(--danger-blockquote-border-left);
    background-color: var(--danger-blockquote-background-color);
}
blockquote[alt="danger"]:before {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    margin: 0px;
    padding-right: 5px;
    font-family: "iconfont";
    content: '\e614';
}

blockquote[alt="success"] {
    border-left: var(--success-blockquote-border-left);
    background-color: var(--success-blockquote-background-color);
}
blockquote[alt="success"]:before {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    margin: 0px;
    padding-right: 5px;
    font-family: "iconfont";
    content: '\e605';
}
/* --------------------------------------------------------------------------------------- */


/* ---------------------------------------- 注释 ----------------------------------------- */
.md-comment{
    font-family: var(--annotation-font-family);
    font-size: var(--annotation-font-size);
    font-weight: var(--annotation-font-weight);
    color: var(--annotation-color);
    line-height: var(--annotation-line-height);
    opacity: 1;
}
/* --------------------------------------------------------------------------------------- */


/* ----------------------------------------- 超链接 --------------------------------------- */
#write a {
    margin: var(--link-margin);
    padding: var(--link-padding);
    font-family: var(--link-font-family);
    font-size: var(--link-font-size);
    font-weight: var(--link-font-weight);
    line-height: var(--link-line-height);
    color: var(--link-color);
    background-color: var(--link-background-color);
    border-bottom: var(--link-border-bottom);
    text-decoration: none;
    cursor: pointer;
}
#write a:hover {
    color: var(--link-hover-color);
    font-weight: var(--link-hover-font-weight);
}
/* --------------------------------------------------------------------------------------- */


/* ----------------------------------------- 字体特效 ------------------------------------- */
/* 小标签 */
font {
    display: inline;
    text-align: center;
    vertical-align: baseline;
    margin: var(--note-margin);
    padding: var(--note-padding);
    font-family: var(--note-font-family);
    font-size: var(--note-font-size);
    font-weight: var(--note-font-weight);
    line-height: var(--note-line-height);
    color: var(--note-color);
    background-color: var(--note-background-color-default);
    border: var(--note-border);
    border-radius: var(--note-border-radius);
}
font[title="red"] {
    background-color:#fe5f58;
}
font[title="yellow"] {
    background-color:#ffc50a;
}
font[title="green"] {
    background-color:#8bc34a;
}
font[title="blue"] {
    background-color:#02aaf4;
}
font[title="gray"] {
    background-color:#4c4c4c;
}

/*  强调型文本  */
span[alt]{
    margin: var(-emp-margin);
    padding: var(--emp-padding);
    font-family: var(--emp-font-family);
    font-size: var(--emp-font-size);
    font-weight: var(--emp-font-weight);
    line-height: var(--emp-line-height);
}
span[alt='solid'] {
    text-decoration-line: underline;
    text-decoration-color: var(--emp-line-color);
    text-decoration-style: solid;
    text-underline-offset: 2px;
    text-decoration-thickness: 2px;
    text-decoration-skip-ink: none;
}
span[alt='dashed'] {
    text-decoration-line: underline;
    text-decoration-color: var(--emp-line-color);
    text-decoration-style: dashed;
    text-underline-offset: 2px;
    text-decoration-thickness: 2px;
    text-decoration-skip-ink: none;
}
span[alt='dotted'] {
    text-decoration-line: underline;
    text-decoration-color: var(--emp-line-color);
    text-decoration-style: dotted;
    text-underline-offset: 2px;
    text-decoration-thickness: 3px;
    text-decoration-skip-ink: none;
}
span[alt='wavy'] {
    text-decoration-line: underline;
    text-decoration-color: var(--emp-line-color);
    text-decoration-style: wavy;
    text-underline-offset: 2px;
    text-decoration-thickness: 2px;
    text-decoration-skip-ink: none;
}
span[alt='delete'] {
    text-decoration-line: line-through;
    text-decoration-color: var(--emp-line-color);
    text-decoration-style: solid;
    text-decoration-thickness: 2px;
}
span[alt='shadow']{
    text-shadow: 1px 1px 2px #FC0;
}

/* 高亮 */
#write span[md-inline="highlight"] mark{
    margin: 0px; 
    padding: 2px 4px;
    font-family: var(--highlight-font-family);
    font-size: var(--highlight-font-size);
    font-weight: var(--hightight-font-weight);
    color: var(--highlight-color);
    background: var(--highlight-background-color);
    border-radius: var(--highlight-border-radius);
}

/* 空心字特效 */
span[alt="hollow"]{
    color:white;
    text-shadow:1px 1px black,-1px -1px black,1px -1px black,-1px 1px black;
}

/* 闪烁特效 */
@keyframes blink-smooth{50%{color:transparent;}}
span[alt="blink"]{
  animation:0.5s blink-smooth infinite alternate linear;
}

/* KBD */
kbd {
    margin: var(--kbd-margin);
    padding: var(--kbd-padding);
    vertical-align: baseline;
    font-family: var(--kbd-font-family);
    font-size: var(--kbd-font-size);
    font-weight: var(--kbd-font-weight);
    color: var(--kbd-color);
    background-color: var(--kbd-background-color);
    border-radius: var(--kbd-border-radius);
    border-width: var(--kbd-border-width);
    border-color: var(--kbd-border-color);
}
/* --------------------------------------------------------------------------------------- */


/* ------------------------------------------ 折叠标签 ------------------------------------ */
details {
	margin: 20px 0px;
    padding: 16px 8px;
}

details>summary {
    display: list-item;
    position: relative;
    margin: -16px -8px;
    padding: 16px 8px;
    font-family: var(--details-title-font-family);
    font-size: var(--details-title-font-size);
    font-weight: var(--details-title-font-weight);
    line-height: var(--details-title-line-height);
    color: var(--details-title-color);
    background: var(--details-title-background-color);
    border: var(--details-border-before);
    border-radius: var(--details-border-radius);
}

details[open] {
    padding: 16px 8px 0px 8px;
    font-family: var(--details-content-font-family);
    font-size: var(--details-content-font-size);
    font-weight: var(--details-content-font-weight);
    line-height: var(--details-content-line-height);
    color: var(--details-content-color);
    background-color: var(--details-content-background-color);
    border: var(--details-border-after);
    border-radius: var(--details-border-radius);
}

details[open]>summary {
    margin-bottom: 0px;
    padding: 16px 8px;
    font-family: var(--details-title-font-family);
    font-size: var(--details-title-font-size);
    font-weight: var(--details-title-font-weight);
    line-height: var(--details-title-line-height);
    color: var(--details-title-color);
    background-color: var(--details-title-background-color);
    border: none;
    border-bottom-right-radius: 0px;
    border-bottom-left-radius: 0px;
}
/* --------------------------------------------------------------------------------------- */


/* --------------------------------------- 水平线 ---------------------------------------- */
hr {
    margin: 0px;
    padding: 0px;
    width: 100%;
    border: none;
    border-bottom: var(--hr-style);
}
/* --------------------------------------------------------------------------------------- */


/* ---------------------------------------- 脚注 ----------------------------------------- */
#write .md-footnote {
    font-family: var(--fontnote-family);
    font-size: var(--fontnote-size);
    font-weight: var(--fontnote-weight);
    line-height: 1.0;
    color: var(--footnote-color);
    background: var(--footnote-bg-color);
}

#write sup.md-footnote{
    margin: 0px;
    padding: 0px;
    border: none;
}
/* --------------------------------------------------------------------------------------- */


/* ---------------------------------------- 参考文献 -------------------------------------- */
.md-def-footnote{
    font-family: var(--font-refer-font-family);
}

.md-def-footnote .md-def-name:before{
    content: '[';
}

.md-def-name{
    padding-left: 1ch;
    padding-right: 1.8ch;
}
/* --------------------------------------------------------------------------------------- */


/* ------------------------------------ 行内数学公式 -------------------------------------- */
[md-inline='inline_math'] {
    color: var(--inline-eq-color);
    font-size: var(--inline-eq-font-size);
}
/* --------------------------------------------------------------------------------------- */


/* ------------------------------------ 普通数学公式 -------------------------------------- */
.md-math-container{
    color: var(--eq-color);
    font-size: var(--eq-font-size);
}
/* --------------------------------------------------------------------------------------- */


/* --------------------------------------- 行内代码 --------------------------------------- */
#write code {
    margin: var(--inline-code-margin);
    padding: var(--inline-code-padding);
    font-family: var(--inline-code-font-family);
    font-size: var(--inline-code-font-size);
    font-weight: var(--inline-code-font-weight);
    line-height: var(--inline-code-line-height);
    color: var(--inline-code-color);
    background-color: var(--inline-code-background-color);
    border-radius: var(--inline-code-border-radius);
}
/* --------------------------------------------------------------------------------------- */


/* ----------------------------------------- 代码块 --------------------------------------- */
/* 代码块顶栏 */
.md-fences {
    padding-top: 30px;
    background-color: var(--code-top-background-color);
    border: var(--code-border);
    border-radius: var(--code-border-radius);
}
.md-fences::before {
    position: absolute;
    left: 10px;
    top: 8px;
    content: '';
    width: 15px;
    height: 15px;
    border-radius: 50%;
    background: rgb(252, 98, 93);
    box-shadow: 25px 0px rgb(253, 188, 64),
                50px 0px rgb(53, 205, 75);
}

/* 代码块主体 */
.cm-s-inner.CodeMirror {
    margin: 0px;
    padding: 6px;
    font-family: var(--code-font-family);
    font-size: var(--code-font-size);
    font-weight: var(--code-font-weight);
    color: var(--code-color);
    background-color: var(--code-body-background-color);
    border-top: 1px solid var(--code-body-border-top-color);
    border-bottom-left-radius: var(--code-border-radius);
    border-bottom-right-radius: var(--code-border-radius);
}

/* 代码块行号 */
.cm-s-inner .CodeMirror-linenumber {
    color: var(--code-linenum-color);
    font-weight: var(--code-linenum-font-weight);
}

/* 代码块光标 */
#write .CodeMirror-cursors .CodeMirror-cursor {
    border-left: var(--code-cursor-border);
}

/* 行号与代码分割线 */
.CodeMirror-wrap .CodeMirror-code pre {
    border-left: var(--code-divided-line-border);
}

/* 代码语言输入框 */
.md-fences .code-tooltip{
    padding: 0px;
    background-color: var(--code-inputbox-color);
}
.code-tooltip .ty-input{
    border: var(--code-inputbox-border);
}
.code-tooltip .ty-input:focus{
    border: var(--code-inputbox-focus-border);
}

/* 选中的行 */
.md-fences.md-focus .CodeMirror-code>div.CodeMirror-activeline {
    background-color: var(--code-selected-line-color);
}

/* 选中的代码 */
.cm-s-inner .CodeMirror-selected {
    background-color: var(--code-selected-code-color) !important;
}
.cm-s-inner .CodeMirror-selectedtext {
    background-color: transparent !important;
}

/* 代码块变量颜色 */
.cm-s-inner .cm-keyword {
    color: #c792ea !important;
}
.cm-s-inner .cm-operator {
    color: #89ddff !important;
}
.cm-s-inner .cm-variable-2 {
    color: #eeffff !important;
}
.cm-s-inner .cm-variable-3 {
    color: #f07178 !important;
}
.cm-s-inner .cm-type {
    color: #f07178 !important;
}
.cm-s-inner .cm-builtin {
    color: #ffcb6b !important;
}
.cm-s-inner .cm-atom {
    color: #f78c6c !important;
}
  .cm-s-inner .cm-number {
    color: #ff5370 !important;
}
.cm-s-inner .cm-def {
    color: rgb(130, 170, 255) !important;
}
.cm-s-inner .cm-string {
    color: #a2c077 !important;
}
.cm-s-inner .cm-string-2 {
    color: #f07178 !important;
}
.cm-s-inner .cm-comment {
    color: #fff !important;
}
.cm-s-inner .cm-variable {
    color: #f07178 !important;
}
.cm-s-inner .cm-tag {
    color: #ff5370 !important;
}
.cm-s-inner .cm-meta {
    color: #ffcb6b !important;
}
.cm-s-inner .cm-attribute {
    color: #c792ea !important;
}
.cm-s-inner .cm-property {
    color: #c792ea !important;
}
.cm-s-inner .cm-qualifier {
    color: #decb6b !important;
}
.cm-s-inner .cm-variable-3,
.cm-s-inner .cm-type {
    color: #decb6b !important;
}
.cm-s-inner .cm-error {
    color: #fff !important;
    background-color: #ff5370 !important;
}
/* --------------------------------------------------------------------------------------- */


/* --------------------------------------- 有序列表 --------------------------------------- */
#write ol {
    margin: var(--order-list-margin);
    padding: var(--order-list-padding);
    font-family: var(--order-list-font-family);
    font-size: var(--order-list-font-size);
    font-weight: var(--order-list-font-weight);
    color: var(--order-list-color);
    line-height: var(--order-list-line-height);
    list-style-type: none;
}

li {
    margin: var(--order-list-li-margin);
}

#write ol li > * {
    margin: 0px 0px 0px var(--order-list-li-indentation);
}

#write ul ol>li::before,
#write ol>li::before {
    position: absolute;
    color: var(--order-list-sign-color);
    content: counter(li) ".";
    counter-increment: li 1;
    width: 22px;
    text-align: right;
    left: -12px;
}

#write ol[start=""],
#write ol:not([start]) {
    counter-reset: li 0;
}

#write ol {
    counter-reset: unset;
}
/* --------------------------------------------------------------------------------------- */


/* --------------------------------------- 无序列表 --------------------------------------- */
#write ul {
    margin: var(--unorder-list-margin);
    padding: var(--unorder-list-padding);
    font-family: var(--unorder-list-font-family);
    font-size: var(--unorder-list-font-size);
    font-weight: var(--unorder-list-font-weight);
    color: var(--unorder-list-color);
    line-height: var(--unorder-list-line-height);
    list-style-type: none;
}

li {
    margin: var(--unorder-list-li-margin);
}

#write ul>li > * {
    margin: 0px 0px 0px var(--unorder-list-li-indentation);
}

#write ul>li:before {
    position: absolute;
    top: var(--unorder-list-sign-top);
    left: var(--unorder-list-sign-left);
    display: inline-block;
    content: '';
    width: var(--unorder-list-sign-width);
    height: var(--unorder-list-sign-height);
    text-align: center;
    vertical-align: middle;
    color: var(--unorder-list-color);
    background-color: var(--unorder-list-background-color);
    border: 2px solid var(--unorder-list-sign-color);
    border-radius: var(--unorder-list-border-radius);
}

#write ul li:first-child {
    counter-reset: li;
}
/* --------------------------------------------------------------------------------------- */


/* ---------------------------------------- 任务列表 ------------------------------------- */
#write .md-task-list-item:before{
    content: none;
}

#write .md-task-list-item>input{
    margin: 0px;
    padding: 0px;
    width: 0px;
    height: 0px;
    line-height: var(--task-line-height);
}

#write .md-task-list-item>input:before {
    display: inline-block;
    content: '';
    width: var(--task-sign-width);
    height: var(--task-sign-height);
    text-align: center;
    vertical-align: middle;
    background-color: var(--task-unselect-background-color);
    border: var(--task-unselect-border);
    border-radius: var(--task-unselect-border-radius);
}

#write .md-task-list-item>input[checked]:before{
    content: '\e63c';
    font-family: "iconfont";
    width: var(--task-sign-width);
    height: var(--task-sign-height);
    text-align: center;
    vertical-align: middle;
    border: none;
}

#write input[type=checkbox] {
    position: absolute;
    top: var(--task-sign-top);
    left: var(--task-sign-left);
}

#write .md-task-list-item p{
    margin: 0px var(--task-content-indentation);
}
/* ------------------------------------------------------------------------------------- */


/* ------------------------------------- 图片 ------------------------------------------ */
.md-image img {
    margin: var(--img-margin);
    padding: var(--img-padding);
    text-align: center;
    border: var(--img-border);
    border-radius: var(--img-border-radius);
    /*content: var(--img-name); eg:counter(imgNum) */
}

#write{
    counter-reset: imgNum;
}

.md-image:after{
    margin-top: 10px;
    display: block;
    text-align: center;
    font-family: var(--img-font-family);
    font-size: var(--img-font-size);
    content: var(--img-name);
    counter-increment: imgNum;
}
/* ------------------------------------------------------------------------------------- */


/* ---------------------------------------- 表格 --------------------------------------- */
/* 普通表格 */
figure{
    display: flex;
    justify-content: center;
    align-items:flex-start;
}
table {
    margin: var(--table-margin);
    padding: var(--table-padding);
    font-family: var(--table-font-family);
    font-size: var(--table-font-size);
    line-height: var(--table-line-height);
    text-align: center;
    // width: var(--table-width);
	// width: 1200px;
}
table tr {
    font-weight: var(--table-tr-font-weight); 
    background-color: var(--table-odd-row-color);
    border: var(--table-border);
}
table tr:nth-child(2n) {
    background-color: var(--table-even-row-color);
    border: var(--table-border);
}
table tr th {
    padding: 5px 10px;
    font-weight: var(--table-th-font-weight); 
    background-color: var(--table-th-background-color);
    border: var(--table-border); 
}
table tr td {
    padding: 5px 10px;
    border: var(--table-border);
}

/* 三线表 */
div[alt="three-table"] table tr {
    border: none;  
    background-color: #fff;
    font-weight: var(--table-tr-font-weight); 
}

div[alt="three-table"] table tr th{
    border: none;
    border-top: 2px solid #000;
    border-bottom: 2px solid #000;
    font-weight: var(--table-th-font-weight); 
    font-size: var(--table-font-size);
    background-color: #fff;
}

div[alt="three-table"] table tr td{
    border: none;
}
div[alt="three-table"] table tr:nth-last-child(1){
    border-bottom: 2px solid #000;
}

*[alt="center"]{
    text-align: center;
}
*[alt="left"]{
    text-align: left;
}
*[alt="right"]{
    text-align: right;
}
/* ------------------------------------------------------------------------------------- */@import url();


*{
	font-family: "MapleMono SC NF Regular";
}

/* 可选字体：
   1.Windows自带字体, 例如: Times New Roman, Consolas, Microsoft YaHei. 详情见"C:\Windows\Fonts"
   2.阿里妈妈普惠体：Ali_PuHuiTi (字粗:100、200、300、...、900)
   3.思源黑体：SiYuan_HeiTi (字粗:100、200、300、...、700)
   4.霞鹜文楷：XiaWuWenKai (字粗:100、200、300)
   5.站酷仓耳渔阳体: ZhanKu_YvYangTi (字粗:100、200、300、400、500)
*/

:root {
    /* body */
    --body-background-color: #c0e6ff;   /* 整个界面的背景颜色 */
    --select-text-bg-color: #ffafa3;    /* 选中文本时文本的背景颜色 */

    /* write */
    --write-margin: 10px auto 10px;                /* 书写框的外边距 */
    --write-padding: 10px 20px;                    /* 书写框的内边距 */
    --write-font-family: 'Ali_PuHuiTi';            /* 全局的字体名称 */
    --write-font-size: 15px;                       /* 全局的字体大小 */
    --write-font-weight: 300;                      /* 全局的字体粗细 */
    --write-line-height: 1.5;                      /* 全局的行高 */
    --write-color: #000;                         /* 全局的字体颜色 */
    --write-background: #fff;                    /* 书写框的背景颜色,使用linear-gradient可以实现渐变色 */
    --write-border: 2px solid rgba(0,0,0,0.75);  /* 书写框的边框 */
    --write-border-radius: 5px;                    /* 书写框的边框圆角 */
    --write-max-width: 80%;                        /* 书写框的所占比例 */

    /* favico */
    --favico-url: url(file:///C://Users//pikachuren//AppData//Roaming//Typora/themes/image/img-1.png);            /* 右下角的图片(可以使用动图),若想取消显示,用"var(--body-bg-color);"替代即可 */
    --favico-size: 10vw auto;                      /* 图片大小 */
    --favico-position: right bottom;               /* 图片位置(可以使用百分比,例如:99% 95%) */ 

    /* YAML */
    --yaml-margin: 20px 0px;
    --yaml-padding: 10px;
    --yaml-font-family: 'XiaWuWenKai';
    --yaml-font-size: 1.0rem;
    --yaml-font-weight: 200;
    --yaml-line-height: 1.5;
    --yaml-color: #000;
    --yaml-background-color: #f0f0f0;
    --yaml-border: 2px solid black;
    --yaml-border-radius: 5px;

    /* 目录 */
    --toc-margin: 20px 0px;
    --toc-padding: 0px;
    --toc-background-color: #fff;
    --toc-border: 2px solid #000;
    --toc-border-radius: 5px;
    --toc-title-font-family: 'SiYuan_HeiTi';       /* ----------设置`目录`二字---------- */
    --toc-title-font-size: 1.0rem;
    --toc-title-font-weight: 500;
    --toc-title-line-height: 1.5;
    --toc-title-color:#000;
    --toc-content-font-family: 'SiYuan_HeiTi';     /* ----------设置目录内容---------- */
    --toc-content-font-size: 1.0rem;
    --toc-content-font-weight: 300;
    --toc-content-line-height: 1.5;
    --toc-content-color: #000;
    --toc-content-border-top: 2px dashed #000;   /* 目录内容的上边框 */
    --toc-content-hover-color: #47b357;          /* 鼠标悬停时字体颜色 */
    --toc-content-hover-font-weight: 500;          /* 鼠标悬停时字体粗细 */

    /* 标题(仅支持h1,h2,h3) */
    --h1-margin: 30px 0px;
    --h1-padding: 0px;
    --h1-font-family: 'SiYuan_HeiTi';
    --h1-font-size: 2.4rem;
    --h1-font-weight: 500;
    --h1-line-height: 1.5;
    --h1-icon: '\e626';                            /* h1标题前的图标*/
    --h1-icon-color: #fe5f58;
    --h1-icon-margin-right: 5px;                   /* 图标与标题的间距*/
    --h1-span-border-bottom: none;

    --h2-margin: 25px 0px;
    --h2-padding: 0px;
    --h2-font-family: 'SiYuan_HeiTi';
    --h2-font-size: 2.0rem;
    --h2-font-weight: 400;
    --h2-line-height: 1.5;
    --h2-icon: '#';
    --h2-icon-color: #fe5f58;
    --h2-icon-margin-right: 5px;
    --h2-span-border-bottom: 3px solid #ff5d52;

    --h3-margin: 20px 0px;
    --h3-padding: 0px;
    --h3-font-family: 'SiYuan_HeiTi';
    --h3-font-size: 1.6rem;
    --h3-font-weight: 300;
    --h3-line-height: 1.5;
    --h3-icon: '\e67f';
    --h3-icon-color: red;
    --h3-icon-margin-right: 5px; 
    --h3-span-border-bottom: none;
    
    /* 引用块 */
    --blockquote-margin: 10px 0px;
    --blockquote-padding: 10px;
    --blockquote-font-family: 'XiaWuWenKai';
    --blockquote-font-size: 1.0rem;
    --blockquote-font-weight: 300;
    --blockquote-line-height: 1.5;
    --blockquote-border-left: 5px solid #a68bff;           /* 默认引用块的左边框 */
    --blockquote-background-color: #f3f0ff;
    --info-blockquote-border-left: 5px solid #5fa7e4;      /* 信息引用块的左边框 */
    --info-blockquote-background-color: #e4edf6;
    --warn-blockquote-border-left: 5px solid #f0ad4e;      /* 警告引用块的左边框 */
    --warn-blockquote-background-color: #FFFACD;
    --danger-blockquote-border-left: 5px solid #db524f;    /* 危险引用块的左边框 */
    --danger-blockquote-background-color: #fdeaea;
    --success-blockquote-border-left: 5px solid #5cb85c;   /* 成功引用块的左边框 */
    --success-blockquote-background-color: #eef7f0;


    /* 注释 */
    --annotation-font-family: "SiYuan_HeiTi";
    --annotation-font-size: 1.0rem;
    --annotation-font-weight: 500;
    --annotation-color: #4e9452;
    --annotation-line-height: 1.5;

    /* 超链接 */
    --link-margin: 2px;
    --link-padding: 0px;
    --link-font-family: 'Ali_PuHuiTi';
    --link-font-size: 1.0rem;
    --link-font-weight: 500;
    --link-line-height: 1.5;
    --link-color: #61abff;
    --link-background-color: #fff;
    --link-border-bottom: 2px solid #000;      /* 超链接的下边框 */
    --link-hover-color: #db524f;
    --link-hover-font-weight: 500;

    /* 小标签 */
    --note-margin: 0px;
    --note-padding: 2px 4px;
    --note-font-family: 'ZhanKu_YvYangTi';
    --note-font-size: 1.0rem;
    --note-font-weight: 400;
    --note-line-height: 1.6;
    --note-color: #fff;
    --note-background-color-default: #6aaf7e;   /* 小标签的默认颜色 */
    --note-border: none;
    --note-border-radius: 2px;

    /* 强调型文本-下划线, 着重号, 波浪线 */
    --emp-margin: 0px;
    --emp-padding: 0px;
    --emp-font-family: 'Ali_PuHuiTi';
    --emp-font-size: 1.0rem;
    --emp-font-weight: 400;
    --emp-line-height: 1.5;
    --emp-line-color: #fe5f58;

    /* 高亮 */
    --highlight-font-family: 'Ali_PuHuiTi';
    --highlight-font-size: 1.0rem;
    --hightight-font-weight: 400;
    --highlight-color: #000;
    --highlight-background-color: #fbe598;
    --highlight-border-radius: 2px;

    /* KBD */
    --kbd-margin: 0px;
    --kbd-padding: 2px 4px;
    --kbd-font-family: 'Consolas';
    --kbd-font-size: 1.0rem;
    --kbd-font-weight: 200;
    --kbd-color: #000;
    --kbd-background-color: #fff;
    --kbd-border-width: 2px;
    --kbd-border-radius: 2px;
    --kbd-border-color: #000;

    /* 折叠标签 */
    --details-title-font-family: 'SiYuan_HeiTi';              /* 折叠标签题目 */
    --details-title-font-size: 1.0rem;                        
    --details-title-font-weight: 600;
    --details-title-line-height: 1.5;                      
    --details-title-color: rgba(0,0,0,0.75);     
    --details-title-background-color: #d0edf1;        
    --details-content-font-family: 'XiaWuWenKai';             /* 折叠标签内容 */
    --details-content-font-size: 1.0rem;                     
    --details-content-font-weight: 300;  
    --details-content-line-height: 1.5;                     
    --details-content-color: rgba(0,0,0,0.75);             
    --details-content-background-color: #fff;
    --details-border-before: 2px solid #000;                /* 展开前的边框 */
    --details-border-after: 2px solid #000;                 /* 展开后的边框 */
    --details-border-radius: 5px;

    /* 水平线 */
    --hr-style: 2px dashed #db524f;

    /* 脚注 */
    --fontnote-family: 'Times New Roman';
    --fontnote-size: 0.8rem;
    --fontnote-weight: 600;
    --footnote-color: #e96900;
    --footnote-background: transparent;

    /* 参考文献 */
    --font-refer-font-family: 'ZhanKu_YvYangTi';

    /* 行内公式 */
    --inline-eq-font-size: 1.0rem;
    --inline-eq-color: blue;
    
    /* 普通公式 */
    --eq-font-size: 1.0rem;
    --eq-color: black;

    /* 行内代码 */
    --inline-code-margin: 0px;
    --inline-code-padding: 2px 4px;
    --inline-code-font-family: 'Consolas';
    --inline-code-font-size: 0.9rem;
    --inline-code-font-weight: 400;
    --inline-code-color: #4c4c4c;
    --inline-code-background-color: #edebeb;
    --inline-code-line-height: 1.5;
    --inline-code-border-radius: 2px;

    /* 代码块颜色 */
    --code-font-family: 'Consolas';
    --code-font-size: 0.9rem;
    --code-font-weight: 400;
    --code-color: #a6accd;
    --code-border: 1px solid #000;
    --code-border-radius: 10px;
    --code-top-background-color:rgb(33, 37, 43);                   /* 代码块头部背景颜色 */
    --code-body-background-color:rgb(41, 45, 62);                  /* 代码块主体背景颜色 */
    --code-body-border-top-color: rgba(167, 178, 189, 0.2);        /* 代码块主体上边框颜色 */
    --code-linenum-color: #f0ad4e;                                 /* 行号颜色 */
    --code-linenum-font-weight: 500;                                 /* 行号字粗 */
    --code-cursor-border: 2px solid #fff;                          /* 光标配置 */
    --code-divided-line-border: 1px solid white;                   /* 分割线配置 */
    --code-inputbox-color: rgba(167, 178, 189, 0.2);               /* 输入框的颜色 */
    --code-inputbox-border: 2px solid #000;                        /* 输入框的边框配置 */
    --code-inputbox-focus-border: 2px solid #61abff;               /* 聚焦后输入框的边框配置 */
    --code-selected-line-color: rgba(167, 178, 189, 0.2);          /* 光标所在代码行的颜色 */
    --code-selected-code-color: rgba(167, 178, 189, 0.2);          /* 选择代码后,代码的背景色 */

    /* 有序列表 */
    --order-list-margin: 10px 0px;
    --order-list-padding: 0px;
    --order-list-font-family: 'SiYuan_HeiTi';
    --order-list-font-size: 1.0rem;
    --order-list-font-weight: 300;
    --order-list-color: #000;
    --order-list-line-height: 2.0;                 /* 有序列表各项的行高 */
    --order-list-li-margin: 10px 0px;              /* 有序列表各项的间距 */
    --order-list-li-indentation: 1.0em;            /* 有序列表内容的缩进 */
    --order-list-sign-color: #db524f;            /* 有序列表的数字颜色 */

    /* 无序列表 */
    --unorder-list-margin: 10px 0px;
    --unorder-list-padding: 0px;
    --unorder-list-font-family: 'SiYuan_HeiTi';
    --unorder-list-font-size: 1.0rem;
    --unorder-list-font-weight: 300; 
    --unorder-list-color: #000;                   /* 无序列表的字体颜色 */
    --unorder-list-line-height: 2.0;                /* 无序列表各项的行高 */
    --unorder-list-li-margin: 10px 0px;             /* 无序列表各项的间距 */
    --unorder-list-li-indentation: 1.2em;           /* 无序列表内容的缩进 */
    --unorder-list-sign-color: #db524f;           /* 无序列表符号的边框颜色 */
    --unorder-list-background-color: #fff;        /* 无序列表符号的背景颜色 */
    --unorder-list-sign-width: 0.8rem;              /* 无序列表符号的宽度 */
    --unorder-list-sign-height: 0.8rem;             /* 无序列表符号的长度 */
    --unorder-list-sign-top: 10px;                  /* 用于调整无序列表符号的位置 */
    --unorder-list-sign-left: 0px;                  /* 用于调整无序列表符号的位置 */
    --unorder-list-border-radius: 100%;             /* 用于调整无序列表符号的形状*/

    /* 任务列表 */
    --task-line-height: 1.2;
    --task-content-indentation: 1.3rem;
    --task-unselect-border: 2px solid #db524f;
    --task-unselect-background-color: #fff;
    --task-unselect-border-radius: 2px;
    --task-sign-width: 1.1rem;
    --task-sign-height: 1.1rem;
    --task-sign-top: 5px;                            /* 用于调整任务列表的符号的位置 */
    --task-sign-left: 0px;                           /* 用于调整任务列表的符号的位置 */

    /* 图片 */
    --img-margin: 20px 0px;
    --img-padding: 0px;
    --img-border: 2px solid #000;
    --img-border-radius: 5px;
    --img-name: '';                                 /* 若想自动编号,用"Fig." counter(imgNum);替代 */
    --img-font-family: 'Times New Roman';
    --img-font-size: 1.0rem;

    /* 表格 */
    --table-margin: 10px 0px;
    --table-padding: 0px;
    --table-width: 80%;                           /* 表格宽度*/
    --table-font-family: 'ZhanKu_YvYangTi';
    --table-font-size: 1.0rem;
    --table-line-height: 1.5;
    --table-th-background-color: #aed3e3;       /* 表头表头背景色 */
    --table-odd-row-color: #ededed;             /* 表格内容奇数行颜色 */
    --table-even-row-color: #e2f2f9;            /* 表格内容偶数行颜色 */
    --table-border: 2px solid #000;             /* 表格边框配置 */
    --table-th-font-weight: 400;                  /* 表格标题字粗 */
    --table-td-font-weight: 300;                  /* 表格内容字粗 */
} 


</style><title>自建时间戳服务器实现伪签名驱动证书</title>
</head>
<body class='typora-export os-windows'><div class='typora-export-content'>
<div id='write'  class=' first-line-indent'><h1><span>自建时间戳服务器实现伪签名驱动证书</span></h1><h1 id='drivers-signning-with-self-sign-fake-timestamp-servers'><span>Drivers Signning with Self-Sign Fake Timestamp Servers</span></h1><p><img src="https://github.com/PIKACHUIM/FakeSign/raw/main/Pictures/20241114143520.png" referrerpolicy="no-referrer" alt="自建时间戳服务器实现伪签名驱动证书"></p><h3 id='20241226更新'><span>2024/12/26更新：</span></h3><p><strong><span>接到通知域名提供者通知，us.kg域名暂时不可用，时间戳地址临时修改为：</span><a href='http://test.timer.opkg.cn/' target='_blank' class='url'>http://test.timer.opkg.cn/</a></strong></p><h2 id='项目介绍--introduction'><span>项目介绍 / Introduction</span></h2><p><span>购买一个代码签名证书非常昂贵，而在Windows平台上，驱动签名需要EV代码签名证书才能进行WHQL认证，EV代码签名证书一年就需要几千块。作为个人开发者或者测试驱动需求，购买权威机构的EV代码签名证书是非常不划算的，同时需要公司认证，时间流程都非常麻烦。微软于2019年7月暂停了EV交叉驱动签名证书CA的签发，意味着这之后不能直接使用EV代码签名，需要WHQL认证。但在这之前签发的证书可以直接签署驱动完成认证。网上有一些泄露的EV代码签名证书，可以利用</span><a href='https://code.52pika.cn/index.php/archives/277/'><span>《自建时间戳服务实现伪签驱动证书》</span></a><span>的时间戳功能完成伪造签名，让签名时间戳在泄露证书有效期内，实现驱动签名和认证。</span></p><p><span>Purchasing a code signing certificate is very expensive, and on the Windows platform, driver signing requires an EV code signing certificate for WHQL authentication, which costs several thousand yuan per year. As an individual developer or test driver, purchasing an EV code signing certificate from an authoritative organization is very uneconomical, and requires company certification, which is a very complicated time process. Microsoft suspended the issuance of EV cross drive signing certificate CA in July 2019, which means that EV code signing cannot be directly used after that and WHQL authentication is required. But certificates issued before this can be directly signed to complete authentication. There are some leaked EV code signature certificates online, which can be used to </span><a href='https://code.52pika.cn/index.php/archives/277/'><span>Implement Pseudo Signature Driver Certificates through Self-built Timestamp Services</span></a><span>  The timestamp function completes the forgery of signatures, allowing the signature timestamp to be within the validity period of the leaked certificate, achieving driver signature and authentication.</span></p><h2 id='免责声明--disclaimers'><span>免责声明 / Disclaimers</span></h2><p><strong><span>本文涉及网络安全实验，阅读本文表示您已经阅读、完全理解并承诺遵守下列条款的全部内容：</span></strong></p><p><strong><span>This article involves network security experiments. Reading this article means that you have read, fully understood, and committed to complying with all the following terms and conditions:</span></strong></p><blockquote><details><summary><strong><red>"Drivers Signning with Self-Sign Fake Timestamp Servers" Disclaimers - English</red></strong></summary><p><strong>Welcome to research and conduct the experiment on &quot;Drivers Signning with Self-Sign Fake Timestamp Servers&quot;</strong></p><p>Before using this experiment,<em><u>Please carefully read and agree to the following disclaimer license terms</u>.</em></p><p><strong>Continuing means that you agree to all the terms</strong>.<em>If you do not agree with any content of this license term,</em></p><p><em><u>Please immediately stop conducting this experiment and delete all content and its derivative data</u>.</em></p><ol start=''><li><h6 id='explanation-of-terms'>Explanation of Terms</h6><ol><li>&quot;Experimental Content&quot;: This includes the technology (including but not limited to code, files, steps) and its derivative content provided by this website experiment.</li><li>&quot;Violation of laws and regulations&quot;: refers to a violation of the relevant laws and regulations mentioned in this agreement and in your country or region, as well as their relevant provisions.</li><li>&quot;Author&quot;: The provider of this experimental technology, including the creator of this document, website provider, and other assistance providers.</li><li>&quot;User&quot;: The subject who uses the technology provided in this experiment (including but not limited to: code, files, steps) and its derivative content.</li></ol></li><li><h6 id='experimental-purpose'>Experimental Purpose</h6><ol><li>This experiment aims to provide practical learning and technical research on network security technology.</li></ol><ol start='2'><li>This experiment is only for individuals or groups to conduct non commercial technological exploration.</li></ol></li></ol><ol start='2'><li><h6 id='usage-restrictions'>Usage Restrictions</h6><ol><li>You promise that the principles of this experiment will only be used for experiments and safety technology testing and technical experiments, and will not be used in confidential or important production environments.</li><li>You are not allowed to use it for any activities that violate laws and regulations, including but not limited to criminal behavior, fraud, damage to computer information systems, etc.</li></ol></li><li><h6 id='legal-compliance'>Legal Compliance</h6><ol><li>You comply with the Cybersecurity Law of the People&#39;s Republic of China and are not allowed to use any technology on this website for illegal or criminal activities.</li><li>You shall comply with Article 286 (1) of the Criminal Law of the People&#39;s Republic of China and shall not use any technology on this website to damage the computer information system.</li><li>You shall comply with Article 32 of the Electronic Signature Law of the People&#39;s Republic of China and shall not use any technology of this website to forge, impersonate, or embezzle the electronic signature of others</li><li>You shall comply with the laws and regulations of China and other countries and regions where you are located, and shall not use any technology on this website to violate laws and regulations, or cause problems or losses to any other individual or group.</li></ol></li><li><h6 id='disclaimer'>Disclaimer</h6><ol><li>This experiment is only for technical and safety technical testing purposes and is not responsible for the user&#39;s behavior</li><li>The principles of this experiment are published on Github and can be freely accessed and used by anyone. The author is not responsible for the user behavior of the experiment.</li><li>The principle of this experiment may have technical, safety, or other issues, and users are required to bear the risk of use and take necessary safety measures to protect their own and others&#39; interests.</li><li>The author shall not be liable for any direct or indirect losses arising from the use of the principles of this experiment, including but not limited to profit losses, data losses, business interruptions, etc.</li><li>This website reserves the right to interrupt or terminate this service at any time without prior notice to users.</li></ol></li><li><h6 id='violations'>Violations</h6><ol>     	<li>If you violate any of the above terms, you will fully and independently bear any legal and other responsibilities and consequences that may arise</li></ol><p>&nbsp;</p><p>Please carefully read and understand the above disclaimer terms before using this service.</p><p>If you agree and accept the above terms, please continue to use this experiment.</p><p>If you have any questions or need further explanation, please contact us.</p></li></ol></details><details>
<summary><strong><red>《自建时间戳服务器实现伪签名驱动证书》免责声明 - 简体中文</red></strong></summary>
<p><span>欢迎您研究并进行《自建时间戳服务器实现伪签名驱动证书》实验（以下简称“本实验”）。</span></p><p><span>在使用本实验前</span><strong><span>请您仔细阅读并同意以下免责许可条款</span></strong><span>，继续则代表您同意条款全部内容。</span></p><p><span>若您不同意本许可条款的任何内容，请立即停止进行本实验，并删除所有内容及其衍数据。</span></p><ol start=""><li><h6 id="术语解释"><span>术语解释</span></h6><ol start=""><li><p><span>“实验内容”：包括本网站实验所提供的技术（包括但不限于代码、文件、步骤）及其衍生内容。</span></p></li><li><p><span>“违反法律法规”：指违反本协议所提及的和您所在国家或地区的相关法律法规，及其相关规定。</span></p></li><li><p><span>“作者”：本实验技术的提供者，包括本文档创建人，网站提供者，以及其他提供帮助的主体等。</span></p></li><li><p><span>“使用者”：使用本实验提供的技术（包括但不限于：代码、文件、步骤）及其衍生内容的主体。</span></p></li></ol><p><strong><span>本文件中的关键词“必须”、“不得”、“要求”、“应”、“不应”、“可”、“不可”、“建议”、“旨在”、“仅（供）”和“可选”</span></strong></p><p><strong><span>应按照RFC2119中的说明进行解释。</span></strong></p></li><li><h6 id="实验目的"><span>实验目的</span></h6><ol start=""><li><p><span>本实验</span><strong><span>旨在</span></strong><span>提供网络安全技术的实践学习和技术研究。</span></p></li><li><p><span>本实验</span><strong><span>仅供</span></strong><span>个人或团体进行非商业性质的技术探索。</span></p></li></ol></li><li><h6 id="使用限制"><span>使用限制</span></h6><ol start=""><li><p><span>您</span><strong><span>必须</span></strong><span>承诺本实验的原理仅用于实验和安全技术测试和技术实验，不用于需保密或者重要生产环境。</span></p></li><li><p><span>您</span><strong><span>不得</span></strong><span>用于任何违反法律法规的活动，包括但不限于犯罪行为、欺诈、破坏计算机信息系统等。</span></p></li></ol></li><li><h6 id="法律合规"><span>法律合规</span></h6><ol start=""><li><p><span>您</span><strong><span>必须</span></strong><span>遵守《中华人民共和国网络安全法》，不得使用本网站任何技术进行违法犯罪活动。</span></p></li><li><p><span>您</span><strong><span>必须</span></strong><span>遵守《中华人民共和国刑法》第286条第1款规定，不得使用本网站的任何技术破坏计算机信息系统。</span></p></li><li><p><span>您</span><strong><span>必须</span></strong><span>遵守《中华人民共和国电子签名法》第32条，不得使用本网站的任何技术伪造、冒用、盗用他人的电子签名</span></p></li><li><p><span>您</span><strong><span>必须</span></strong><span>遵守中国以及其他所在国家和地区的法律法规，不得使用本网站的任何技术违反法律法规，或者给其他任何个人、团体造成问题或者损失。</span></p></li></ol></li><li><h6 id="免责声明"><span>免责声明</span></h6><ol start=""><li><p><span>本实验</span><strong><span>仅</span></strong><span>提供技术实验和安全技术测试之用，不对使用者的行为负责</span></p></li><li><p><span>本实验的原理发布在Github上，任何人均可自由获取和使用，作者不对实验的使用者行为负责。</span></p></li><li><p><span>本实验的原理</span><strong><span>可能</span></strong><span>存在技术问题、安全问题或其他问题，使用者需自行承担使用风险，并采取必要的安全措施保护自身和他人的利益。</span></p></li><li><p><span>作者对于使用本实验的原理所产生的任何直接或间接损失，包括但不限于利润损失、数据损失、业务中断等，不承担责任。</span></p></li><li><p><span>本网站保留在任何时候中断或终止本服务的权利，而无需提前通知使用者。</span></p></li></ol></li><li><h6 id="违规情形"><span>违规情形</span></h6><p><strong><span>您如果违反上述条款的任何内容，您将完全独立承担带来的任何法律以及其他责任和后果。</span></strong></p></li></ol><p><span>请您在使用本服务前认真阅读并理解上述免责许可条款。若您同意并接受上述条款，请继续使用本实验。</span></p><p><span>如有任何疑问或需要进一步解释，请联系我们。</span></p>
</details></blockquote><h2 id='简易使用--quick-usage'><span>简易使用 / Quick Usage</span></h2><h3 id='简易使用方法--easy-way-to-sign-drivers'><span>简易使用方法 / Easy Way to Sign Drivers</span></h3><ol start='' ><li><p><span>下载时间证书信任工具：</span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/PikachuTestCert.exe'><span>数字证书安装工具</span></a><span>，双击EXE，根据安装流程信任证书文件</span></p><p><span>（Download Time Certificate Trust Tool: </span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/PikachuTestCert.exe'><span>Digital Certificate Installation Tool</span></a><span>）</span></p><p><span>如果需要静默安装，则应该运行（If silent installation is required, it should be run）：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="cmd"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="cmd"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2667px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-identifier">PikachuTestCert</span><span class="cm-punctuation">.</span><span class="cm-identifier">exe</span> <span class="cm-operator">/</span><span class="cm-identifier">VERYSILENT</span> <span class="cm-comment"># 隐藏任何安装窗口和提示（需要管理员权限）</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-identifier">PikachuTestCert</span><span class="cm-punctuation">.</span><span class="cm-identifier">exe</span> <span class="cm-operator">/</span><span class="cm-identifier">SILENT</span> &nbsp; &nbsp; <span class="cm-comment"># 隐藏安装确认但显示进度（需要管理员权限）</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 54px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></pre></li><li><p><span>安装泄露驱动签名证书：</span><strong><span>我不提供任何证书</span></strong><span>，你可以去查找（</span><a href='https://github.com/wanttobeno/FuckCertVerifyTime/tree/master/代码签名数字证书'><span>FuckCertVerifyTime</span></a><span>）</span></p><p><span>（Install leaked driver signature certificate: </span><strong><span>I do not provide any certificate </span></strong><span>(</span><a href='https://github.com/wanttobeno/FuckCertVerifyTime/tree/master/'><span>FuckCertVerifiyTime</span></a><span>) ）</span></p></li><li><p><span>下载驱动代码签名工具：</span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/TimestampClient.zip'><span>亚洲诚信签名工具</span></a><span>，打开软件选择[</span><strong><span>自定义时间戳</span></strong><span>]进行签名：</span></p><p><span>（Download the driver code signing tool: </span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/TimestampClient.zip'><span>Asia Integrity Signature Tool</span></a><span>, and then: ）</span></p><ol start='' ><li><p><span>首先需要修改</span><code>inf文件</code><span>，修改</span><code>DriverVer</code><span>的日期部分，修改到</span><strong><span>签名证书的时间范围</span></strong><span>内：</span></p><p><span>It is necessary to open the </span><code>.inf</code><span> files and modify the </span><code>DriverVer</code><span> to the time range of the signning certificate:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="inf"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="inf"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">DriverVer = 01/01/2015,1.0.1.0</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><p><span>签名</span><code>*.SYS</code><span>和其他文件（</span><code>.dll</code><span>、</span><code>.exe</code><span>等），</span><strong><span>签名的时间需要大于或等于第一步的驱动版本时间</span></strong><span>：</span></p><p><span>Signature </span><code>*.SYS</code><span> and other files, </span><strong><span>sign time needs to be greater than or equal to the DriverVer time </span></strong><span>:</span></p><ol start='' ><li><p><span>修改</span><code>hook.ini</code><span>，将</span><code>TimeStamp</code><span>内的值修改为</span><strong><span>不低于上一步时间的值</span></strong><span>：</span></p><p><span>Modify </span><code>hook.ini</code><span> to change the value in &#39;Timestamptamp&#39; to </span><strong><span>not lower than the value of the previous step time</span></strong><span>:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2668px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">[TimeStamp]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">TimeStamp=2015-01-01T08:00:00</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">ServerURL=http://test.timer.us.kg/</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 81px;"></div><div class="CodeMirror-gutters" style="display: none; height: 81px;"></div></div></div></pre></li><li><p><span>打开</span><strong><span>DSignTool.exe</span></strong><span>，点击[</span><strong><span>规则管理</span></strong><span>]——[</span><strong><span>添加</span></strong><span>]——勾选[</span><strong><span>将时间戳添加到数据中</span></strong><span>] ——选中 [定义的时间戳]</span></p><p><span>Open </span><strong><span>DSignTool.exe*</span></strong><span>, click [Rule Management] - [Add] - check [Add Timestamp] - select [Defined Timestamp]</span></p></li><li><p><span>点击[</span><strong><span>数字签名</span></strong><span>]——拖入待签名的</span><code>*.SYS</code><span>和其他文件（</span><code>.dll</code><span>、</span><code>.exe</code><span>等），点击[数字签名]——选[双签名]或[SHA1]——驱动模式</span></p><p><span>Click on [Digital Signature] - drag in the </span><code>*.sys</code><span> other files to be signed</span></p><p><span>Click on [Digital Signature] - select [Double Signature] or [SHA1] - [Drive Mode]</span></p></li></ol></li><li><p><span>修改系统时间，</span><strong><span>修改的时间需要大于或等于第一步的驱动版本时间</span></strong><span>，修改命令如下：</span></p><p><span>Modify the system time, </span><strong><span>The time needs to be greater than or equal to the driver version time of the first step</span></strong><span>. </span></p><p><span>The modification command is as follows:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="cmd"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="cmd"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2668px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-identifier">date</span> <span class="cm-number">2015</span><span class="cm-operator">/</span><span class="cm-number">01</span><span class="cm-operator">/</span><span class="cm-number">01</span> <span class="cm-operator">&amp;&amp;</span> <span class="cm-identifier">time</span> <span class="cm-number">08</span><span class="cm-operator">:</span><span class="cm-number">00</span><span class="cm-operator">:</span><span class="cm-number">00</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><p><span>使用</span><code>infcat</code><span>创建CAT目录文件，需要先安装</span><a href='https://learn.microsoft.com/zh-cn/windows-hardware/drivers/download-the-wdk'><span> Windows 驱动程序工具包 (WDK) </span></a></p><p><span>To create a CAT directory file by </span><code>infcat</code><span>, you need to first install the </span><a href='https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk'><span>Windows Driver Kit (WDK)</span></a></p><ol start='' ><li><p><span>X86和X64驱动签名命令(X86 and X64 signning commands)：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="cmd"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="cmd"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-identifier">inf2cat</span> <span class="cm-operator">/</span><span class="cm-identifier">v</span> <span class="cm-operator">/</span><span class="cm-identifier">os</span><span class="cm-operator">:</span><span class="cm-identifier">XP_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">Vista_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">Vista_X64</span><span class="cm-punctuation">,</span><span class="cm-number">7</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">7</span><span class="cm-identifier">_X64</span><span class="cm-punctuation">,</span><span class="cm-number">8</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">8</span><span class="cm-identifier">_X64</span><span class="cm-punctuation">,</span><span class="cm-number">6</span><span class="cm-identifier">_3_X86</span><span class="cm-punctuation">,</span><span class="cm-number">6</span><span class="cm-identifier">_3_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_X64</span> <span class="cm-operator">/</span><span class="cm-identifier">driver</span><span class="cm-operator">:</span><span class="cm-punctuation">.</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><p><span>X86和X64完整签名命令(X86 and X64 fully signning commands)：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="cmd"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="cmd"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.1732px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-identifier">inf2cat</span> <span class="cm-operator">/</span><span class="cm-identifier">v</span> <span class="cm-operator">/</span><span class="cm-identifier">os</span><span class="cm-operator">:</span><span class="cm-number">2000</span><span class="cm-punctuation">,</span><span class="cm-identifier">XP_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">XP_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Vista_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">Vista_X64</span><span class="cm-punctuation">,</span><span class="cm-number">7</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">7</span><span class="cm-identifier">_X64</span><span class="cm-punctuation">,</span><span class="cm-number">8</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">8</span><span class="cm-identifier">_X64</span><span class="cm-punctuation">,</span><span class="cm-number">6</span><span class="cm-identifier">_3_X86</span><span class="cm-punctuation">,</span><span class="cm-number">6</span><span class="cm-identifier">_3_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_AU_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_AU_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS2_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS2_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS3_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS3_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS4_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS4_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS5_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS5_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_19H1_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_19H1_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_VB_X86</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_VB_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_CO_X64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_NI_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2003_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2003_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2008_X86</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2008_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2008R2_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server8_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server6_3_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server10_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">SERVER2016_X64</span><span class="cm-punctuation">,</span><span class="cm-identifier">ServerRS5_X64</span> <span class="cm-operator">/</span><span class="cm-identifier">driver</span><span class="cm-operator">:</span><span class="cm-punctuation">.</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 135px;"></div><div class="CodeMirror-gutters" style="display: none; height: 135px;"></div></div></div></pre></li><li><p><span>A64和I64驱动签名命令(ARM and A64 driver signning commands)：</span></p></li></ol><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="cmd"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="cmd"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.1733px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; <span class="cm-identifier">inf2cat</span> <span class="cm-operator">/</span><span class="cm-identifier">os</span><span class="cm-operator">:</span><span class="cm-identifier">Server2003_IA64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2008_IA64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server2008R2_IA64</span><span class="cm-punctuation">,</span><span class="cm-identifier">Server10_ARM64</span><span class="cm-punctuation">,</span><span class="cm-identifier">ServerRS5_ARM64</span><span class="cm-punctuation">,</span><span class="cm-identifier">ServerFE_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS3_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS4_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_RS5_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_19H1_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_VB_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_CO_ARM64</span><span class="cm-punctuation">,</span><span class="cm-number">10</span><span class="cm-identifier">_NI_ARM64</span> <span class="cm-operator">/</span><span class="cm-identifier">v</span> <span class="cm-operator">/</span><span class="cm-identifier">driver</span><span class="cm-operator">:</span><span class="cm-punctuation">.</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 81px;"></div><div class="CodeMirror-gutters" style="display: none; height: 81px;"></div></div></div></pre></li><li><p><span>签名</span><code>*.cat</code><span>文件，</span><strong><span>签名的时间需要大于或等于第三步的CAT时间</span></strong><span>：</span></p></li></ol><p><span>Sign the </span><code>*.cat</code><span> file, and the signing time needs to be greater than or equal to the CAT time of the third step</span></p><ol start='' ><li><p><span>修改</span><code>hook.ini</code><span>，将</span><code>TimeStamp</code><span>内的值修改为</span><strong><span>不低于上一步时间的值</span></strong></p><p><span>Modify </span><code>hook.ini</code><span> to change the value in &#39;Timestamptamp&#39; to </span><strong><span>not lower than the value of the previous step time</span></strong><span>:</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang=""><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang=""><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2668px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; [TimeStamp]</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">TimeStamp=2015-01-01T09:00:00</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; ServerURL=http://test.timer.us.kg/</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 81px;"></div><div class="CodeMirror-gutters" style="display: none; height: 81px;"></div></div></div></pre><ol start='2' ><li><p><span>打开</span><strong><span>DSignTool.exe</span></strong><span>，点击[</span><strong><span>规则管理</span></strong><span>]——[</span><strong><span>添加</span></strong><span>]——勾选[</span><strong><span>将时间戳添加到数据中</span></strong><span>] ——选中 [定义的时间戳]</span></p></li></ol><p><span>Open </span><strong><span>DSignTool.exe*</span></strong><span>, click [Rule Management] - [Add] - check [Add Timestamp] - select [Defined Timestamp]</span></p></li><li><p><span>点击[</span><strong><span>数字签名</span></strong><span>]——拖入待签名的</span><code>*.cat</code><span>文件，点击[数字签名]——选[双签名]或[SHA1]——[驱动模式]签名即可</span></p><p><span>Click on [Digital Signature] - drag in the </span><code>*.cat</code><span> to be signed</span></p><p><span>Click on [Digital Signature] - select [Double Signature] or [SHA1] - [Drive Mode]</span></p></li></ol></li><li><p><span>备注信息 / Notice：</span></p><ol start='' ><li><p><span>上述教程无需自建TSA服务，如有需要自己搭建的，可以直接前往</span><a href='https://test.certs.us.kg/'><span>皮卡丘公共服务测试根证书</span></a><span>申请您的时间戳证书</span></p></li><li><p><span>签名时间顺序：驱动版本时间&lt;=sys/dll签名时间&lt;=CAT创建时间&lt;=CAT签名时间</span></p></li><li><p><span>The above tutorial does not require building your own TSA service. </span></p><p><span>If you need to build it yourself, go to </span><a href='https://test.certs.us.kg/'><span>Pikachu Public Test CA</span></a><span> Apply for your timestamp certificate</span></p></li><li><p><span>Signing time sequence: Driver version time&lt;=sys/dll Signature time&lt;=CAT creation time&lt;=CAT signature time</span></p></li></ol></li></ol><p>&nbsp;</p><h4 id='附录cat签名使用的inf2cat版本号对照表'><span>附录：CAT签名使用的Inf2Cat版本号对照表</span></h4><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>Windows 版本</span></th><th style='text-align:left;' ><span>版本标识符</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><span>Windows 11，版本 22H2 x64 Edition</span></td><td style='text-align:left;' ><span>10_NI_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 11，版本 22H2 Arm64 版本</span></td><td style='text-align:left;' ><span>10_NI_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 11，版本 21H2 x64 Edition</span></td><td style='text-align:left;' ><span>10_CO_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 11，版本 21H2 Arm64 版本</span></td><td style='text-align:left;' ><span>10_CO_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2022 x64 版本</span></td><td style='text-align:left;' ><span>ServerFE_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2022 Arm64 Edition</span></td><td style='text-align:left;' ><span>ServerFE_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 22H2、21H2、21H1、20H2、2004 x86 版本</span></td><td style='text-align:left;' ><span>10_VB_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 22H2、21H2、21H1、20H2、2004 x64 版本</span></td><td style='text-align:left;' ><span>10_VB_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 22H2、21H2、21H1、20H2、2004 Arm64 版本</span></td><td style='text-align:left;' ><span>10_VB_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1909、1903 x86 版本</span></td><td style='text-align:left;' ><span>10_19H1_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1909、1903 x64 版本</span></td><td style='text-align:left;' ><span>10_19H1_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1909、1903 Arm64 Edition</span></td><td style='text-align:left;' ><span>10_19H1_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10 版本 1809 x86 版本</span></td><td style='text-align:left;' ><span>10_RS5_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10 版本 1809 x64 版本</span></td><td style='text-align:left;' ><span>10_RS5_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10 版本 1809 Arm64 版本</span></td><td style='text-align:left;' ><span>10_RS5_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2019 x64 Edition</span></td><td style='text-align:left;' ><span>ServerRS5_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2019 Arm64 Edition</span></td><td style='text-align:left;' ><span>ServerRS5_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1803 x86 Edition</span></td><td style='text-align:left;' ><span>10_RS4_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1803 x64 Edition</span></td><td style='text-align:left;' ><span>10_RS4_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1803 Arm64 Edition</span></td><td style='text-align:left;' ><span>10_RS4_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1709 x86 Edition</span></td><td style='text-align:left;' ><span>10_RS3_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1709 x64 Edition</span></td><td style='text-align:left;' ><span>10_RS3_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1709 Arm64 Edition</span></td><td style='text-align:left;' ><span>10_RS3_ARM64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1703 x86 Edition</span></td><td style='text-align:left;' ><span>10_RS2_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1703 x64 Edition</span></td><td style='text-align:left;' ><span>10_RS2_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10版本 1607 x86 Edition</span></td><td style='text-align:left;' ><span>10_AU_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10，版本 1607 x64 Edition</span></td><td style='text-align:left;' ><span>10_AU_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2016 x64 版本</span></td><td style='text-align:left;' ><span>SERVER2016_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10 x86 版本</span></td><td style='text-align:left;' ><span>10_X86</span></td></tr><tr><td style='text-align:left;' ><span>Windows 10 x64 版本</span></td><td style='text-align:left;' ><span>10_X64</span></td></tr><tr><td style='text-align:left;' ><span>Windows Server 2016</span></td><td style='text-align:left;' ><span>Server10_X64</span></td></tr><tr><td style='text-align:left;' ><span>arm 上的Windows Server 2016</span></td><td style='text-align:left;' ><span>Server10_ARM64</span></td></tr></tbody></table></figure><p>&nbsp;</p><p>&nbsp;</p><blockquote><h4 id='开安全启动驱动签名步骤'><span>开安全启动驱动签名步骤</span></h4><p><span>1、修改inf文件为时间1（在过期证书有效期内，最好是颁发的时候）</span></p><p><span>2、亚洲诚信工具签名用过期EV交叉证书签名sys文件（时间1）</span></p><p><span>3、修改系统时间为时间2（时间2&gt;=时间1）</span></p><p><span>4、inf2cat立即生成cat</span></p><p><span>5、亚洲诚信工具签名cat文件（时间3&gt;=时间2）</span></p></blockquote><h3 id='部署时间证书--deploy-timestamp-server'><span>部署时间证书 / Deploy Timestamp Server</span></h3><p><span>（一般情况不需要这个操作，你只需参考前一个“简易使用方法”内的教程即可）</span></p><p><span>1、生成一张时间戳证书(</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>教程XCA自制CA证书并签发时间戳证书</span></a><span>)，或者在这里申请一张：</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>皮卡丘测试证书在线服务</span></a></p><p><span>2、下载</span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/TimestampServer.zip'><span>自信任时间戳工具</span></a><span>，解压并按照您的情况修改</span><code>config.json</code><span>，然后以</span><strong><span>管理员权限</span></strong><span>运行：</span><code>TimeStamping.exe</code></p><p><span>3、修改</span><code>hook.ini</code><span>中的</span><code>ServerURL</code><span>项为你自建的服务器地址，参考“简易使用方法”里面的教程，正常执行签名即可</span></p><h3 id='二合一整合包--tsa-server--signtool-2in1'><span>二合一整合包 / TSA Server + Signtool 2in1</span></h3><p><span>（一般情况不需要这个操作，你只需参考前一个“简易使用方法”内的教程即可）</span></p><p><span>1、生成一张时间戳证书(</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>教程XCA自制CA证书并签发时间戳证书</span></a><span>)，或者在这里申请一张：</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>皮卡丘测试证书在线服务</span></a></p><p><span>2、下载</span><a href='https://github.com/PIKACHUIM/FakeSign/raw/refs/heads/main/Releases/TimestampAllin1.zip'><span>自信任整合包签名</span></a><span>，解压并按照您的情况修改</span><code>config.json</code><span>，然后以</span><strong><span>管理员权限</span></strong><span>运行：</span><code>TimeStamping.exe</code></p><p><span>3、修改</span><code>hook.ini</code><span>中的</span><code>ServerURL</code><span>项为你自建的服务器地址，参考“简易使用方法”里面的教程，正常执行签名即可</span></p><h3 id='驱动生成cat--driver-cat-create-usage'><span>驱动生成CAT / Driver Cat Create Usage</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8908px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">inf2cat /v /os:XP_X86,Vista_X86,Vista_X64,7_X86,7_X64,8_X86,8_X64,6_3_X86,6_3_X64,10_X86,10_X64 /driver:.</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><h3 id='添加时间方法--time-signature-methods'><span>添加时间方法 / Time Signature Methods</span></h3><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8908px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">signtool timestamp /t <span class="cm-string">"http://&lt;ServerHost:Port&gt;/{SHA1|SHA256}/YYYY-MM-DDTHH:mm:ss"</span> &lt;待签名程序&gt;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><h4 id='添加时间示例--signature-examples'><span>添加时间示例 / Signature Examples</span></h4><h5 id='单独添加时间戳序号1）'><span>单独添加时间戳（序号=1）</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8908px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">signtool timestamp /tp <span class="cm-number">1</span> /tr <span class="cm-string">"http://test.timer.us.kg/2011-01-01T00:00:00"</span> test.exe</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><h5 id='代码签名时间戳sha160）'><span>代码签名时间戳（SHA160）</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8908px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">signtool.exe sign /f Cert.pfx /p password /tr <span class="cm-string">"http://test.timer.us.kg/2011-01-01T00:00:00"</span> /as /v test.exe</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><h5 id='代码签名时间戳sha256）'><span>代码签名时间戳（SHA256）</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8913px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">signtool.exe sign /f Cert.pfx /p password /fd sha256 /tr <span class="cm-string">"http://test.timer.us.kg/2011-01-01T00:00:00"</span> /td sha256 /as /v test.exe</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 20px;"></div><div class="CodeMirror-gutters" style="display: none; height: 20px;"></div></div></div></pre><h2 id='实现原理--principles'><span>实现原理 / Principles</span></h2><ul><li><h3 id='微软内核模式驱动代码签名要求'><span>微软内核模式驱动代码签名要求：</span></h3><p><img src="https://github.com/PIKACHUIM/FakeSign/raw/main/Pictures/20230425155145.jpg" referrerpolicy="no-referrer" alt="20230425155145"></p><figure class='table-figure'><table><thead><tr><th style='text-align:left;' ><span>适用于：</span></th><th style='text-align:left;' ><span>Windows Vista、Windows 7;带安全启动的 Windows 8+</span></th><th style='text-align:left;' ><span>Windows 8、Windows 8.1、Windows 10 版本 1507、1511 以及安全启动</span></th><th style='text-align:left;' ><span>Windows 10 版本 1607、1703、1709 以及安全启动</span></th><th style='text-align:left;' ><span>Windows 10 版本 1803 及安全启动</span></th></tr></thead><tbody><tr><td style='text-align:left;' ><strong><span>架构：</span></strong></td><td style='text-align:left;' ><span>仅 64 位，32 位不需要签名</span></td><td style='text-align:left;' ><span>64 位、32 位</span></td><td style='text-align:left;' ><span>64 位、32 位</span></td><td style='text-align:left;' ><span>64 位、32 位</span></td></tr><tr><td style='text-align:left;' ><strong><span>需要签名：</span></strong></td><td style='text-align:left;' ><span>嵌入文件或目录文件</span></td><td style='text-align:left;' ><span>嵌入文件或目录文件</span></td><td style='text-align:left;' ><span>嵌入文件或目录文件</span></td><td style='text-align:left;' ><span>嵌入文件或目录文件</span></td></tr><tr><td style='text-align:left;' ><strong><span>签名算法：</span></strong></td><td style='text-align:left;' ><span>SHA2</span></td><td style='text-align:left;' ><span>SHA2</span></td><td style='text-align:left;' ><span>SHA2</span></td><td style='text-align:left;' ><span>SHA2</span></td></tr><tr><td style='text-align:left;' ><strong><span>证书：</span></strong></td><td style='text-align:left;' ><span>代码完整性信任的标准根</span></td><td style='text-align:left;' ><span>代码完整性信任的标准根</span></td><td style='text-align:left;' ><span>Microsoft 根证书颁发机构 2010、Microsoft 根证书颁发机构、Microsoft 根证书颁发机构</span></td><td style='text-align:left;' ><span>Microsoft 根证书颁发机构 2010、Microsoft 根证书颁发机构、Microsoft 根证书颁发机构</span></td></tr></tbody></table></figure></li><li><h3 id='微软禁用内核驱动强制签名方法'><span>微软禁用内核驱动强制签名方法：</span></h3><ul><li><p><span>Windows 10 1607 之后UEFI引导模式，并且开启Secure Boot选项：</span></p><ul><li><p><span>无法开启测试模式，</span><em><span>不能通过修改BCD解决</span></em><span>，</span><strong><span>可以使用EFIGuard</span></strong></p></li><li><p><span>每次可以开机进入</span><u><span>高级模式</span></u><span>-选择</span><u><span>禁用内核驱动强制签名</span></u><span>启动</span></p></li></ul></li><li><p><span>Windows 10 1607 之前，Win8/8.1/7/Vista，或者关闭Secure Boot：</span></p><ul><li><p><strong><span>开启测试模式</span></strong><span>： </span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /enum all</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /set {default} testsigning on</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /set nointegritychecks on</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /set testsigning on</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /debug ON</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">bcdedit /bootdebug ON</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 162px;"></div><div class="CodeMirror-gutters" style="display: none; height: 162px;"></div></div></div></pre></li><li><p><span>也可以每次可以开机进入</span><u><span>高级模式</span></u><span>-选择</span><u><span>禁用内核驱动强制签名</span></u><span>启动</span></p></li></ul></li></ul></li><li><h3 id='伪造签名原理'><span>伪造签名原理</span></h3><p><img src="https://github.com/PIKACHUIM/FakeSign/raw/main/Pictures/20230425160222.jpg" referrerpolicy="no-referrer" alt="伪造签名原理"></p><ul><li><h4 id='自建伪造时间戳服务器'><span>自建伪造时间戳服务器</span></h4><p><strong><span>您可以直接前往</span><a href='https://test.certs.us.kg/'><span>皮卡丘公共服务测试根证书</span></a><span>一键申请您自己的时间戳证书，无需再自建，自建教程：</span></strong></p><blockquote><ul><li><p><span>自建CA证书（CA=TRUE，密钥用法=Certificate Signing, Off-line CRL Signing, CRL Signing，增强型密钥用法=2.5.29.32.0）</span></p></li><li><p><span>自签时间戳签名证书（密钥用途=Digital Signature，增强型密钥用法=时间戳 ，OCSP-URL，CRL-URL）</span></p></li><li><p><span>设置CRL地址（推荐Nginx，把CRL文件放入对应地址），或者设置OCSP服务器（OpenSSL OCSP）</span></p></li><li><p><span>搭建并启动时间戳响应服务器（</span><em><span>RFC</span></em><span>3161以及Authenticode格式 ，需要同时支持SHA1+SHA256）</span></p></li></ul></blockquote><p>&nbsp;</p></li></ul></li></ul><p>&nbsp;</p><h2 id='自建时间服务--tsa-server'><span>自建时间服务 / TSA Server</span></h2><p><span>上述教程无需自建TSA服务，如有需要自己搭建的，可以直接前往</span><a href='https://test.certs.us.kg/'><span>皮卡丘公共服务测试根证书</span></a><span>申请您的时间戳证书</span></p><p><span>The above tutorial does not require building your own TSA service. </span></p><p><span>If you need to build it yourself, go to </span><a href='https://test.certs.us.kg/'><span>Pikachu Public Test CA</span></a><span> Apply for your timestamp certificate</span></p><h3 id='直接修改配置文件推荐）'><span>直接修改配置文件（推荐）</span></h3><ul><li><h4 id='打开文件'><span>打开文件</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="json" style="break-inside: unset;"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="json"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">{</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"listen_path"</span>: <span class="cm-string">"/TSA/"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"listen_addr"</span>: <span class="cm-string">"localhost"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"listen_port"</span>: <span class="cm-string">"1003"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"server_urls"</span>: <span class="cm-string">"http://test.timer.us.kg/"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"server_cert"</span>: <span class="cm-string">"TSA.crt"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"server_keys"</span>: <span class="cm-string">"TSA.key"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"server_fake"</span>: <span class="cm-string">"true"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"windows_url"</span>: <span class="cm-string">""</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"linuxos_url"</span>: <span class="cm-string">""</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"signers_url"</span>: <span class="cm-string">""</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"githubs_url"</span>: <span class="cm-string">"https://github.com/PIKACHUIM/FakeSign"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"article_url"</span>: <span class="cm-string">"https://code.52pika.cn/index.php/archives/277/"</span>,</span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string cm-property">"service_url"</span>: <span class="cm-string">"https://test.certs.us.kg/"</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 405px;"></div><div class="CodeMirror-gutters" style="display: none; height: 405px;"></div></div></div></pre><p>&nbsp;</p></li></ul><h3 id='vs编译构建时间戳服务器'><span>VS编译构建时间戳服务器</span></h3><ul><li><h4 id='下载项目'><span>下载项目</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">git</span> clone https://github.com/PIKACHUIM/FakeSign.git</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><h4 id='修改代码'><span>修改代码</span></h4><p><span>编辑：</span><code>TimeTool/Develop/TimeStamping/Program.cs</code></p><p><span>如果要使用伪造服务器，则此处填写</span><code>true</code><span>，如果要使用真实时间，应当填写</span><code>false</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c#"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c#"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">static</span> <span class="cm-keyword">readonly</span> <span class="cm-variable-3">string</span> <span class="cm-variable">supportFake</span> <span class="cm-operator">=</span> <span class="cm-string">@"true"</span>;</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><h4 id='编译构建'><span>编译构建</span></h4><p><span>输出：</span><code>TimeTool/Develop/TimeStamping/bin/Debug</code></p></li></ul><h3 id='windows部署服务推荐）'><span>Windows部署服务（推荐）</span></h3><ol start='' ><li><p><span>创建一个CA和时间戳证书，参考</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>XCA自制CA证书并签发时间戳证书</span></a></p></li><li><p><span>放置证书文件到当前的运行目录内，需要参考下面的文件说明：</span></p><ul><li><p><strong><span>TSA.crt 证书Base64编码</span></strong></p></li><li><p><strong><span>TSA.key 密钥Base64编码</span></strong></p></li></ul></li><li><p><span>双击：</span><code>TimeStamping.exe</code><span>即可运行</span></p></li></ol><h3 id='ubuntu部署服务不推荐）'><span>Ubuntu部署服务（不推荐）</span></h3><h4 id='安装wine'><span>安装Wine</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 14.8908px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> dpkg <span class="cm-attribute">--add-architecture</span> i386</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> apt-get install wine mono-complete winetricks wine32 winbind</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 40px;"></div><div class="CodeMirror-gutters" style="display: none; height: 40px;"></div></div></div></pre><h4 id='安装net'><span>安装.Net</span></h4><ul><li><h5 id='自动安装'><span>自动安装</span></h5><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">sudo</span> winetricks dotnet45</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><h4 id='手动安装'><span>手动安装</span></h4><ol start='' ><li><p><span>下载文件 </span><a href='Download/wine-mono-7.4.0-x86.msi'><span>wine-mono-7.4.0-x86.msi</span></a><span> </span></p></li><li><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2676px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">wine uninstaller</span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">wine64 uninstaller</span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 54px;"></div><div class="CodeMirror-gutters" style="display: none; height: 54px;"></div></div></div></pre><p><span>安装上一步下载的MSI文件(wine-mono-7.4.0-x86.msi)</span></p></li></ol></li><li><h4 id='运行服务'><span>运行服务</span></h4><p><span>创建一个CA和时间戳证书，参考</span><a href='https://code.52pika.cn/index.php/archives/330/'><span>XCA自制CA证书并签发时间戳证书</span></a></p><p><span>放置证书文件到当前的运行目录内，需要参考下面的文件说明：</span></p><ul><li><p><strong><span>TSA.crt 证书Base64编码</span></strong></p></li><li><p><strong><span>TSA.key 密钥Base64编码</span></strong></p></li></ul><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">wine TimeStamping.exe</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li></ul><h2 id='构建签名工具--build-sign-tool'><span>构建签名工具 / Build Sign Tool</span></h2><p><span>正常情况不需要自行搭建服务器，如果有需要使用自己的服务器，请继续阅读</span></p><p><span>Under normal circumstances, it is not necessary to set up a server on your own. </span></p><p><span>If you need to use your own server, please continue reading.</span></p><h3 id='直接修改hookini文件推荐）'><span>直接修改hook.ini文件（推荐）</span></h3><ul><li><h4 id='修改文件'><span>修改文件</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="ini"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="ini"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-header">[TimeStamp]</span></span></pre></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">TimeStamp</span>=<span class="cm-quote">2015-01-01T00</span>:<span class="cm-quote">00</span>:<span class="cm-quote">00</span></span></pre><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-def">ServerURL</span>=<span class="cm-quote">http</span>:<span class="cm-quote">//localhost</span>:<span class="cm-quote">1003/TSA/</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 81px;"></div><div class="CodeMirror-gutters" style="display: none; height: 81px;"></div></div></div></pre></li></ul><h3 id='vs编译hooksigntool'><span>VS编译HookSigntool</span></h3><ul><li><h4 id='下载项目-2'><span>下载项目</span></h4><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="shell"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="shell"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">git</span> clone https://github.com/PIKACHUIM/FakeSign.git</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><h4 id='修改代码-2'><span>修改代码</span></h4><p><span>编辑：</span><code>SignTool/Hooktool/main.cpp</code><span>，取消注释下列行：</span></p><p><span>将里面的</span><code>http://*********/fake/RSA/</code><span>修改为</span><code>http://你的地址:端口/路径</code></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="c++"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="c++"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 18.2666px; left: 10.7663px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">wcscat</span>(<span class="cm-variable">buf</span>, <span class="cm-string">L"http://*********/fake/RSA/"</span>);</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom: 0px solid transparent; top: 27px;"></div><div class="CodeMirror-gutters" style="display: none; height: 27px;"></div></div></div></pre></li><li><h4 id='编译构建-2'><span>编译构建</span></h4><p><span>输出：</span><code>SignTool/Hooktool/bin/Debug</code></p><p>&nbsp;</p></li></ul><h2 id='参考资料--reference'><span>参考资料 / Reference</span></h2><blockquote><p><span>[1] 时间戳签名库以及本地Demo服务器，可以倒填时间制造有效签名，JemmyloveJenny，吾爱破解，</span><a href='https://www.52pojie.cn/thread-908684-1-1.html' target='_blank' class='url'>https://www.52pojie.cn/thread-908684-1-1.html</a></p><p><span>[2] 亚洲诚信数字签名工具修改版 自定义时间戳 驱动签名，JemmyloveJenny，吾爱破解，</span><a href='https://www.52pojie.cn/thread-1027420-1-1.html' target='_blank' class='url'>https://www.52pojie.cn/thread-1027420-1-1.html</a></p><p><span>[3] 关于Windows驱动签名认证的大致总结，</span><a href='https://space.bilibili.com/1337311595'><span>ANY_LNK</span></a><span>，BiliBili，</span><a href='https://www.bilibili.com/read/cv17812616' target='_blank' class='url'>https://www.bilibili.com/read/cv17812616</a></p><p><span>[4] 数字证书伪造与利用（仅方便用于驱动开发人员的调试，不得非法使用），MIAIONE，BiliBili，</span><a href='https://www.bilibili.com/read/cv9802857/' target='_blank' class='url'>https://www.bilibili.com/read/cv9802857/</a></p></blockquote></div></div>
</body>
</html>